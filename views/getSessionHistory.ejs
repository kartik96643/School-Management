<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ðŸ“š Session History</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background: linear-gradient(to bottom right, #e3f2fd, #ffffff);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #333;
      min-height: 100vh;
      padding-top: 50px;
    }

    .container {
      animation: fadeIn 0.6s ease-in-out;
    }

    h2.session-title {
      font-weight: 700;
      color: #0d6efd;
      margin-bottom: 30px;
      text-align: center;
      text-shadow: 1px 1px 2px rgba(13, 110, 253, 0.2);
    }

    .table thead th {
      background-color: #0d6efd;
      color: white;
      text-align: center;
    }

    .table tbody td {
      text-align: center;
    }

    .alert {
      margin-top: 50px;
      text-align: center;
    }

    .btn-primary {
      border-radius: 50px;
      padding: 10px 25px;
      font-weight: 600;
      transition: all 0.3s ease-in-out;
    }

    .btn-primary:hover {
      transform: scale(1.05);
      box-shadow: 0 0 12px rgba(13, 110, 253, 0.4);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

     @media print {
      .no-print {
        display: none;
      }
    }
  </style>
</head>

<body>
  <% if (user) { %>
    <%- include('navbar.ejs') %>
  <div class="container">
    <% if (data && data.length > 0) { %>
    <h2 class="session-title">ðŸ“˜ Session: <%= data[0].session %> | Class: <%= data[0].className %></h2>

    <div class="table-responsive">
      <table class="table table-bordered table-hover shadow">
        <thead>
          <tr>
            <th>S.No.</th>
            <th>Registration No.</th>
            <th>Student Name</th>
            <th>Total Fees</th>
            <th>Fees Paid</th>
            <th>Dues</th>
            <th>Promoted To:</th>
            <th>Grade</th>
            <th>Percentage:</th>
            <th>Result Date</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <% data.forEach((d, index) => { %>
          <tr>
            <td><%= index + 1 %></td>
            <td><%= d.registrationNo %></td>
            <td><%= d.studentName %></td>
            <td><%= d.totalFees %></td>
            <td><%= d.feesPaid %></td>
            <td><%= d.totalFees - d.feesPaid %></td>
            <td><%= d.promotedTo %></td>
            <td><%= d.grade %></td>
            <td><%= d.percentage %></td>
            <td><%= new Date(d.resultDate).toLocaleString() %></td>
              <td class="text-center" id="edit-btn"><a  href="/sessionHistory/edit/<%= d.registrationNo %>/<%= d.session %>/<%= d.className %>"
                        class="btn btn-outline-primary btn-sm">
                        Edit
                      </a></td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

     <div class="text-center mt-4">
        <button class="btn btn-primary no-print" onclick="window.print()">Print</button>
        <button class="btn"><a href="/sessionHistory" class="btn btn-primary no-print">Back</a></button>
      </div>
   
    <% } else { %>
    <div class="alert alert-warning">
      ðŸš« No data found for the selected session and class.
    </div>
    <% } %>
  </div>
  <% } else { %>
  <div class="container d-flex justify-content-center align-items-center" style="height: 80vh;">
    <div class="text-center">
      <h2 class="text-danger">ðŸš« You are not authorized to view this page.</h2>
      <a href="/login" class="btn btn-primary mt-3">Go to Login</a>
    </div>
  </div>
  <% } %>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
