<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff Registration</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #f8f9fa, #e3f2fd);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }

    .container {
      max-width: 900px;
      width: 100%;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      padding: 3rem 2rem;
      animation: fadeIn 1s ease-in-out;
    }

    .form-container h2 {
      font-weight: bold;
      color: #0d6efd;
      text-shadow: 1px 1px 2px rgba(13, 110, 253, 0.2);
    }

    .form-label {
      font-weight: 600;
      color: #333;
    }

    input.form-control {
      border: 2px solid #ced4da;
      border-radius: 10px;
      transition: all 0.3s ease;
      box-shadow: none;
    }

    input.form-control:focus,
    select.form-control:focus {
      border-color: #0d6efd;
      box-shadow: 0 0 5px rgba(13, 110, 253, 0.5);
      outline: none;
    }

    .alert-danger {
      background-color: #ffdddd;
      border-left: 5px solid #dc3545;
      padding: 1rem;
      border-radius: 10px;
      color: #a10000;
      margin-bottom: 1rem;
    }

    .alert-danger ul {
      margin: 0;
      padding-left: 1.2rem;
    }

    .alert-danger li {
      font-size: 0.95rem;
    }

    p[style*="color: red"] {
      font-size: 0.85rem;
      margin-top: 0.3rem;
    }

    button.btn-primary {
      background: linear-gradient(to right, #0d6efd, #0b5ed7);
      border: none;
      border-radius: 50px;
      padding: 0.75rem;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease-in-out;
    }

    button.btn-primary:hover {
      background: linear-gradient(to right, #0b5ed7, #0d6efd);
      box-shadow: 0 0 10px rgba(13, 110, 253, 0.5);
      transform: scale(1.02);
    }

    a.btn-outline-primary {
      border-radius: 50px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    a.btn-outline-primary:hover {
      background-color: #0d6efd;
      color: white !important;
      transform: scale(1.02);
      box-shadow: 0 0 10px rgba(13, 110, 253, 0.3);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body>

  <div class="container">
    <% if(user.role === 'ADMIN' || user.role ==='NORMAL'){ %>
    <div class="form-container">
      <h2 class="text-center text-primary mb-4">ðŸ“„ Staff Registration Form</h2>

      <% if (errors && errors.length > 0) { %>
        <div class="alert alert-danger">
          <ul>
            <% errors.forEach(error => { %>
              <li><%= error.msg %></li>
            <% }) %>
          </ul>
        </div>
      <% } %>

      <form action="/teacher/register" method="POST">
        <div class="row g-3">

          <div class="col-md-6 ">
            <label for="empId" class="form-label">Employee Id</label>
            <input type="text" class="form-control" id="empId" name="empId" required
             
              value="<%= formdata && formdata.empId ? formdata.empId : '' %>">
            <% if (errors && errors.length) {
              for (let i = 0; i < errors.length; i++) {
                if (errors[i].param === 'empId') { %>
                  <p style="color: red;"><%= errors[i].msg %></p>
            <% break; }}} %>
          </div>
          <div class="col-md-6 ">
            <label for="jobTitle" class="form-label">Job Title</label>
            <input type="text" class="form-control" id="jobTitle" name="jobTitle" required
              pattern="^[^0-9]*$" title="Numbers are not allowed"
              value="<%= formdata && formdata.jobTitle ? formdata.jobTitle : '' %>">
            <% if (errors && errors.length) {
              for (let i = 0; i < errors.length; i++) {
                if (errors[i].param === 'jobTitle') { %>
                  <p style="color: red;"><%= errors[i].msg %></p>
            <% break; }}} %>
          </div>
          <div class="col-md-6">
            <label for="teacherName" class="form-label"> Name</label>
            <input type="text" class="form-control" id="teacherName" name="teacherName" required
              pattern="^[^0-9]*$" title="Numbers are not allowed"
              value="<%= formdata && formdata.teacherName ? formdata.teacherName : '' %>">
            <% if (errors && errors.length) {
              for (let i = 0; i < errors.length; i++) {
                if (errors[i].param === 'teacherName') { %>
                  <p style="color: red;"><%= errors[i].msg %></p>
            <% break; }}} %>
          </div>

          <div class="col-md-6">
            <label for="teacherEmail" class="form-label">Email Address</label>
            <input type="email" class="form-control" id="teacherEmail" name="teacherEmail" required
              value="<%= formdata && formdata.teacheremail ? formdata.teacheremail : '' %>">
            <% if (errors && errors.length) {
              for (let i = 0; i < errors.length; i++) {
                if (errors[i].param === 'teacheremail') { %>
                  <p style="color: red;"><%= errors[i].msg %></p>
            <% break; }}} %>
          </div>

          <div class="col-md-6">
            <label for="teacherContact" class="form-label">Contact No.</label>
            <input type="text" class="form-control" id="teacherContact" name="teacherContact" required maxlength="10"
              pattern="\d{10}" title="Enter exactly 10 digits"
              value="<%= formdata && formdata.teachercontact ? formdata.teachercontact : '' %>">
            <% if (errors && errors.length) {
              for (let i = 0; i < errors.length; i++) {
                if (errors[i].param === 'teachercontact') { %>
                  <p style="color: red;"><%= errors[i].msg %></p>
            <% break; }}} %>
          </div>

          <div class="col-md-6 teacher-only">
            <label for="teacherSubject" class="form-label">Teacher Subject</label>
            <input type="text" placeholder="e.g. Hindi , English , none" class="form-control" id="teacherSubject"
              name="teacherSubject"  oninput="removeNumbers(this)">
          </div>

          <div class="col-md-6 teacher-only">
            <label for="teacherClass" class="form-label">Teacher Classes </label>
            <input type="text" class="form-control" id="teacherClass" name="teacherClass"
              placeholder="e.g. 1, 2"
              pattern="^\s*[a-zA-Z0-9 ]+\s*(,\s*[a-zA-Z0-9 ]+\s*)*$"
              title="Enter values separated by commas (e.g. 1, 2B)" >
          </div>

          <div class="col-md-6">
            <label for="teachersalary" class="form-label">Salary</label>
            <input type="number" class="form-control" id="teacherSalary" name="teacherSalary" required
              value="<%= formdata && formdata.teachersalary ? formdata.teachersalary : '' %>">
            <% if (errors && errors.length) {
              for (let i = 0; i < errors.length; i++) {
                if (errors[i].param === 'teachersalary') { %>
                  <p style="color: red;"><%= errors[i].msg %></p>
            <% break; }}} %>
          </div>

          <!-- Gender Dropdown -->
          <div class="col-md-6">
            <label for="gender" class="form-label">Gender</label>
            <select class="form-control" id="gender" name="gender" required>
              <option value="" disabled selected>Select Gender</option>
              <option value="Male" <%= formdata && formdata.gender === 'Male' ? 'selected' : '' %>>Male</option>
              <option value="Female" <%= formdata && formdata.gender === 'Female' ? 'selected' : '' %>>Female</option>
            </select>
            <% if (errors && errors.length) {
              for (let i = 0; i < errors.length; i++) {
                if (errors[i].param === 'gender') { %>
                  <p style="color: red;"><%= errors[i].msg %></p>
            <% break; }}} %>
          </div>

          <!-- Medium Dropdown (with "Both") -->
          <div class="col-md-6 teacher-only">
            <label for="medium" class="form-label">Medium</label>
            <select class="form-control" id="medium" name="medium" >
              <option value="" disabled selected>Select Medium</option>
              <option value="Hindi" <%= formdata && formdata.medium === 'Hindi' ? 'selected' : '' %>>Hindi</option>
              <option value="English" <%= formdata && formdata.medium === 'English' ? 'selected' : '' %>>English</option>
              <option value="Both" <%= formdata && formdata.medium === 'Both' ? 'selected' : '' %>>Both</option>
            </select>
            <% if (errors && errors.length) {
              for (let i = 0; i < errors.length; i++) {
                if (errors[i].param === 'medium') { %>
                  <p style="color: red;"><%= errors[i].msg %></p>
            <% break; }}} %>
          </div>

        </div>

        <div class="row mt-4">
          <div class="col-md-8 d-grid">
            <button type="submit" class="btn btn-primary btn-lg">Submit</button>
          </div>
          <div class="col-md-4 d-grid">
            <a href="/teacher/list" class="btn btn-outline-primary btn-lg">View Staff âž¡</a>
          </div>
          </div>
          <div class="text-center mt-5">
                <a href="/" class="btn btn-outline-primary">â¬… Back to Dashboard</a>
              </div>

      </form>
    </div>
    <% } else{%>
      <h2> You are not Authorized to access this page.</h2>
      <% } %>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const teacherInput = document.getElementById('teacherName');
    teacherInput.addEventListener('keypress', function (e) {
      if (/\d/.test(e.key)) e.preventDefault();
    });
    teacherInput.addEventListener('paste', function (e) {
      if (/\d/.test(e.clipboardData.getData('text'))) e.preventDefault();
    });
    teacherInput.addEventListener('drop', function (e) {
      if (/\d/.test(e.dataTransfer.getData('text'))) e.preventDefault();
    });

    const teacherContact = document.getElementById('teacherContact');
    teacherContact.addEventListener('input', function () {
      this.value = this.value.replace(/\D/g, '').slice(0, 10);
    });
    teacherContact.addEventListener('paste', function (e) {
      const pasted = e.clipboardData.getData('text');
      if (!/^\d{1,10}$/.test(pasted)) e.preventDefault();
    });

    function removeNumbers(input) {
      input.value = input.value.replace(/[0-9]/g, '');
    }

  const jobTitleInput = document.getElementById('jobTitle');
  const teacherFields = document.querySelectorAll('.teacher-only');

  function toggleTeacherFields() {
    const value = jobTitleInput.value.trim().toLowerCase();
    const isTeacher = value === 'teacher';

    teacherFields.forEach(field => {
      field.style.display = isTeacher ? 'block' : 'none';
      const input = field.querySelector('input');
      if (input) {
        input.required = isTeacher;
        if (!isTeacher) input.value = '';
      }
    });
  }

  jobTitleInput.addEventListener('input', toggleTeacherFields);
  document.addEventListener('DOMContentLoaded', toggleTeacherFields);
  </script>
</body>

</html>
